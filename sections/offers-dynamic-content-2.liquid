<div {% if section.settings.inside_image != blank %}class="row"{% else %}class="row"{% endif %}>
  {% capture image_layout %}
    <div class="feature-row__item col-md-6" style="position:relative;" >
      {% if section.settings.overlay_text %}<div style="position: absolute; bottom:0; top:0; right:0; left: 0; z-index: 3;" class="d-flex align-items-center justify-content-center text-white"><h1>{{ section.settings.overlay_text | upcase }}</h1></div>{% endif %}
      <div style="background-image: url({{ section.settings.image | img_url: '600x' }}); background-size: cover; background-position: center; position: absolute; top: 0;bottom:0;right:0;left:0;">
      </div>
    </div>
  {% endcapture %}

  {% capture inside_image_layout %}
    <div class="" style="position: relative;">
      {% if section.settings.inside_image != blank %}
        {% capture img_id %}FeatureRowImage-{{ section.id }}{% endcapture %}
        {% capture wrapper_id %}FeatureRowImageWrapper-{{ section.id }}{% endcapture %}
        {%- assign img_url = section.settings.inside_image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
        {% include 'image-style' with image: section.settings.inside_image, width: 545, height: 545, small_style: true, wrapper_id: wrapper_id, img_id: img_id %}
          <img id="{{ img_id }}"
              class="blur-up responsive-image__image feature-row__image lazyload img img-responsive"
              src="{{ section.settings.image | img_url: '300x', scale: 2 }}"
              data-src="{{ img_url }}"
              data-widths="[180, 360, 540, 720, 900, 1080, 1296, 1512, 1728, 2048]"
              data-aspectratio="{{ article.image.aspect_ratio }}"
              data-sizes="auto"
              alt="">
        <noscript>
          {{ section.settings.image | img_url: '600x600', scale: 2 | img_tag: section.settings.image.alt, 'feature-row__image' }}
        </noscript>
      {% else %}
        {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
      {% endif %}
    </div>
  {% endcapture %}

    {% if section.settings.layout == 'left' %}
      {{ image_layout }}
    {% endif %}

    <div {% if section.settings.inside_image != blank %}class="feature-row__item col-md-6 feature-row__text feature-row__text--{{ section.settings.layout }}"{% else %}class="narrow feature-row__item col-md-6 feature-row__text large feature-row__text--{{ section.settings.layout }}"{% endif %}>
      {% if section.settings.inside_image != blank%}
        <div class="row d-flex align-items-center">
        <div class="col-12" style="padding: 1em 3em 0;">
      {% endif %}
        {% if section.settings.title != blank %}
          {% if section.settings.inside_image == blank%}
            <h2 class="h2">{{ section.settings.title | escape }}</h2>
          {% else %}
            <h3 class="h3">{{ section.settings.title | escape }}</h3>
          {% endif %}
        {% endif %}
        {% if section.settings.text != blank %}
          <div class="rte rte-setting featured-row__subtext">{{ section.settings.text }}</div>
        {% endif %}
        {% if section.settings.button_label != blank and section.settings.button_link != blank %}
          <a href="{{ section.settings.button_link }}" class="btn">
            {{ section.settings.button_label | escape }}
          </a>
        {% endif %}

      {% include 'add-to-cart-button' %}

    {% if section.settings.inside_image != blank%}
      </div>
      <div class="col-12" style="padding: 2em 0 0;">
      {{ inside_image_layout }}
      </div>
    </div>
  {% endif %}

  </div>
      {% if section.settings.layout == 'right' %}
      {{ image_layout }}
    {% endif %}
</div>
{% schema %}
  {
    "name": {
      "en": "Image with text row",
      "de": "Foto mit Text",
      "fr": "Image avec du texte",
      "it": "Immagine con testo",
      "ja": "テキスト付き画像",
      "es": "Imagen con texto",
      "pt-BR": "Imagem com texto"
    },
    "class": "index-section index-section--flush",
    "settings": [
      {
        "type": "image_picker",
        "id": "image",
        "label": {
          "en": "Image",
          "de": "Foto",
          "fr": "Image",
          "it": "Immagine",
          "ja": "画像",
          "es": "Imagen",
          "pt-BR": "Imagem"
        }
      },
      {
        "type": "image_picker",
        "id": "inside_image",
        "label": {
          "en": "Inside Image",
          "de": "Foto",
          "fr": "Image",
          "it": "Immagine",
          "ja": "画像",
          "es": "Imagen",
          "pt-BR": "Imagem"
        }
      },
      {
        "type": "select",
        "id": "layout",
        "label": {
          "en": "Image alignment",
          "de": "Fotoausrichtung",
          "fr": "Alignement de l'image",
          "it": "Allineamento immagine",
          "ja": "画像アラインメント",
          "es": "Alineación de imagen",
          "pt-BR": "Alinhamento da imagem"
        },
        "default": "left",
        "options": [
          {
            "value": "left",
            "label": {
              "en": "Left",
              "de": "Links",
              "fr": "Gauche",
              "it": "Sinistra",
              "ja": "左",
              "es": "Izquierda",
              "pt-BR": "Esquerda"
            }
          },
          {
            "value": "right",
            "label": {
              "en": "Right",
              "de": "Rechts",
              "fr": "Droite",
              "it": "Destra",
              "ja": "右",
              "es": "Derecha",
              "pt-BR": "Direita"
            }
          }
        ]
      },
      {
        "type": "text",
        "id": "title",
        "label": {
          "en": "Heading",
          "de": "Titel",
          "fr": "En-tête",
          "it": "Heading",
          "ja": "見出し",
          "es": "Título",
          "pt-BR": "Título"
        },
        "default": {
          "en": "Image with text",
          "de": "Foto mit Text",
          "fr": "Image avec du texte",
          "it": "Immagine con testo",
          "ja": "テキスト付き画像",
          "es": "Imagen con texto",
          "pt-BR": "Imagem com texto"
        }
      },
      {
        "type": "richtext",
        "id": "text",
        "label": {
          "en": "Text",
          "de": "Text",
          "fr": "Texte",
          "it": "Testo",
          "ja": "テキスト",
          "es": "Texto",
          "pt-BR": "Texto"
        },
        "default": {
          "en": "<p>Pair large text with an image to give focus to your chosen product, collection, or blog post. Add details on availability, style, or even provide a review.</p>",
          "de": "<p>Kombinieren Sie große Schrift mit einem Foto, um einen Fokus auf Ihr ausgewähltes Produkt, die Kategorie oder einen Blogpost zu legen. Dazu Details zur Verfügbarkeit, Stil oder ein Review.</p>",
          "fr": "<p>Ajoutez une image à un long texte pour mettre l'accent sur un produit de votre choix, une collection, ou un article de blog. Ajoutez des détails sur la disponibilité, le style, ou mettez un commentaire client en avant.</p>",
          "it": "<p>Associa un testo di grandi dimensioni a un'immagine per dare importanza al prodotto, alla collezione o all'articolo del blog di tua scelta. Aggiungi dettagli sulla disponibilità, sullo stile o fornisci una recensione.</p>",
          "ja": "<p>あなたが選んだ商品、コレクション、またはブログ投稿に注目を集めるため、大きなテキストと画像を組み合わせます。可用性、スタイル、またはレビュー提供についての詳細を追加します。</p>",
          "es": "<p>Vincula un texto largo con una imagen para dar visibilidad a tu producto, colección o publicación de blog elegida. Agrega detalles sobre disponibilidad, estilo, o incluso ofrece una reseña.</p>",
          "pt-BR": "<p>Emparelhe textos grandes com uma imagem para dar foco ao produto, coleção ou postagem do blog escolhido. Adicione detalhes sobre disponibilidade, estilo ou até mesmo um comentário.</p>"
        }
      },
      {
        "type": "text",
        "id": "overlay_text",
        "label": {
          "en": "Overlay Text",
          "de": "Titel",
          "fr": "En-tête",
          "it": "Heading",
          "ja": "見出し",
          "es": "Título",
          "pt-BR": "Título"
        }
      },
      {
        "type": "text",
        "id": "button_label",
        "label": {
          "en": "Button label",
          "de": "Button-Etikett",
          "fr": "Texte du bouton",
          "it": "Etichetta pulsante",
          "ja": "ボタンラベル",
          "es": "Etiqueta de botón",
          "pt-BR": "Etiqueta do botão"
        }
      },
      {
        "type": "url",
        "id": "button_link",
        "label": {
          "en": "Button link",
          "de": "Button-Link",
          "fr": "Lien du bouton",
          "it": "Link pulsante",
          "ja": "ボタンリンク",
          "es": "Enlace de botón",
          "pt-BR": "Link do botão"
        }
      }
    ],
    "presets": [
      {
        "name": {
          "en": "Image with text row",
          "de": "Foto mit Text",
          "fr": "Image avec texte",
          "it": "Immagine con testo",
          "ja": "テキスト付き画像",
          "es": "Imagen con texto",
          "pt-BR": "Imagem com texto"
        },
        "category": {
          "en": "Image",
          "de": "Foto",
          "fr": "Image",
          "it": "Immagine",
          "ja": "画像",
          "es": "Imagen",
          "pt-BR": "Imagem"
        }
      }
    ]
  }
{% endschema %}
